(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[875],{5616:function(e){e.exports={vertex:"precision mediump float;\n\nattribute vec2 aPosition;\nattribute vec2 aLumaPosition;\nattribute vec2 aChromaPosition;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vLumaPosition = aLumaPosition;\n    vChromaPosition = aChromaPosition;\n}\n",fragment:"// inspired by https://github.com/mbebenita/Broadway/blob/master/Player/canvas.js\n\nprecision mediump float;\n\nuniform sampler2D uTextureY;\nuniform sampler2D uTextureCb;\nuniform sampler2D uTextureCr;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n   // Y, Cb, and Cr planes are uploaded as ALPHA textures.\n   float fY = texture2D(uTextureY, vLumaPosition).w;\n   float fCb = texture2D(uTextureCb, vChromaPosition).w;\n   float fCr = texture2D(uTextureCr, vChromaPosition).w;\n\n   // Premultipy the Y...\n   float fYmul = fY * 1.1643828125;\n\n   // And convert that to RGB!\n   gl_FragColor = vec4(\n     fYmul + 1.59602734375 * fCr - 0.87078515625,\n     fYmul - 0.39176171875 * fCb - 0.81296875 * fCr + 0.52959375,\n     fYmul + 2.017234375   * fCb - 1.081390625,\n     1\n   );\n}\n",vertexStripe:"precision mediump float;\n\nattribute vec2 aPosition;\nattribute vec2 aTexturePosition;\nvarying vec2 vTexturePosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vTexturePosition = aTexturePosition;\n}\n",fragmentStripe:"// extra 'stripe' texture fiddling to work around IE 11's poor performance on gl.LUMINANCE and gl.ALPHA textures\n\nprecision mediump float;\n\nuniform sampler2D uStripe;\nuniform sampler2D uTexture;\nvarying vec2 vTexturePosition;\nvoid main() {\n   // Y, Cb, and Cr planes are mapped into a pseudo-RGBA texture\n   // so we can upload them without expanding the bytes on IE 11\n   // which doesn't allow LUMINANCE or ALPHA textures\n   // The stripe textures mark which channel to keep for each pixel.\n   // Each texture extraction will contain the relevant value in one\n   // channel only.\n\n   float fLuminance = dot(\n      texture2D(uStripe, vTexturePosition),\n      texture2D(uTexture, vTexturePosition)\n   );\n\n   gl_FragColor = vec4(0, 0, 0, fLuminance);\n}\n"}},5053:function(e){!function(){"use strict";function t(e,t){throw Error("abstract")}t.prototype.drawFrame=function(e){throw Error("abstract")},t.prototype.clear=function(){throw Error("abstract")},e.exports=t}()},4820:function(e,t,r){!function(){"use strict";var t=r(5053),i=r(2521);function a(e){var t=e.getContext("2d"),r=null,a=null,n=null;return this.drawFrame=function(o){var T,E,u,R=o.format;(e.width!==R.displayWidth||e.height!==R.displayHeight)&&(e.width=R.displayWidth,e.height=R.displayHeight),(null===r||r.width!=R.width||r.height!=R.height)&&function(e,i){for(var a=(r=t.createImageData(e,i)).data,n=e*i*4,o=0;o<n;o+=4)a[o+3]=255}(R.width,R.height),i.convertYCbCr(o,r.data);var f=R.cropWidth!=R.displayWidth||R.cropHeight!=R.displayHeight;f?(a||(T=R.cropWidth,E=R.cropHeight,(a=document.createElement("canvas")).width=T,a.height=E,n=a.getContext("2d")),u=n):u=t,u.putImageData(r,-R.cropLeft,-R.cropTop,R.cropLeft,R.cropTop,R.cropWidth,R.cropHeight),f&&t.drawImage(a,0,0,R.displayWidth,R.displayHeight)},this.clear=function(){t.clearRect(0,0,e.width,e.height)},this}a.prototype=Object.create(t.prototype),e.exports=a}()},478:function(e,t,r){!function(){"use strict";var t=r(5053),i=r(5616);function a(e){var t,r,n,o,T,E,u,R,f,c,_,m,A=this,s=a.contextForCanvas(e);if(null===s)throw Error("WebGL unavailable");function h(e,t){var r=s.createShader(e);if(s.shaderSource(r,t),s.compileShader(r),!s.getShaderParameter(r,s.COMPILE_STATUS)){var i=s.getShaderInfoLog(r);throw s.deleteShader(r),Error("GL shader compilation for "+e+" failed: "+i)}return r}var d=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),p={},x={},l={};function v(e,t){return(!p[e]||t)&&(p[e]=s.createTexture()),p[e]}function P(e,t,r,i,n){var o=!p[e]||t,T=v(e,t);if(s.activeTexture(s.TEXTURE0),a.stripe){var E=!p[e+"_temp"]||t,u=v(e+"_temp",t);s.bindTexture(s.TEXTURE_2D,u),E?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,r/4,i,0,s.RGBA,s.UNSIGNED_BYTE,n)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,r/4,i,s.RGBA,s.UNSIGNED_BYTE,n);var R=p[e+"_stripe"],f=!R||t;f&&(R=v(e+"_stripe",t)),s.bindTexture(s.TEXTURE_2D,R),f&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,r,1,0,s.RGBA,s.UNSIGNED_BYTE,function(e){if(l[e])return l[e];for(var t=new Uint32Array(e),r=0;r<e;r+=4)t[r]=255,t[r+1]=65280,t[r+2]=16711680,t[r+3]=4278190080;return l[e]=new Uint8Array(t.buffer)}(r,1)))}else s.bindTexture(s.TEXTURE_2D,T),o?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,r,i,0,s.ALPHA,s.UNSIGNED_BYTE,n)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,r,i,s.ALPHA,s.UNSIGNED_BYTE,n)}function U(e,t,i,a){var f=p[e];s.useProgram(r);var c=x[e];(!c||t)&&(s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,f),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,i,a,0,s.RGBA,s.UNSIGNED_BYTE,null),c=x[e]=s.createFramebuffer()),s.bindFramebuffer(s.FRAMEBUFFER,c),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,f,0);var _=p[e+"_temp"];s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,_),s.uniform1i(R,1);var m=p[e+"_stripe"];s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,m),s.uniform1i(u,2),s.bindBuffer(s.ARRAY_BUFFER,n),s.enableVertexAttribArray(o),s.vertexAttribPointer(o,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,T),s.enableVertexAttribArray(E),s.vertexAttribPointer(E,2,s.FLOAT,!1,0,0),s.viewport(0,0,i,a),s.drawArrays(s.TRIANGLES,0,d.length/2),s.bindFramebuffer(s.FRAMEBUFFER,null)}function g(e,r,i){s.activeTexture(r),s.bindTexture(s.TEXTURE_2D,p[e]),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.uniform1i(s.getUniformLocation(t,e),i)}function b(e,t){var r=h(s.VERTEX_SHADER,e),i=h(s.FRAGMENT_SHADER,t),a=s.createProgram();if(s.attachShader(a,r),s.attachShader(a,i),s.linkProgram(a),!s.getProgramParameter(a,s.LINK_STATUS)){var n=s.getProgramInfoLog(a);throw s.deleteProgram(a),Error("GL program linking failed: "+n)}return a}return A.drawFrame=function(h){var p=h.format,x=!t||e.width!==p.displayWidth||e.height!==p.displayHeight;if(x&&(e.width=p.displayWidth,e.height=p.displayHeight,A.clear()),t||function(){if(a.stripe){r=b(i.vertexStripe,i.fragmentStripe),s.getAttribLocation(r,"aPosition"),T=s.createBuffer();var e=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);s.bindBuffer(s.ARRAY_BUFFER,T),s.bufferData(s.ARRAY_BUFFER,e,s.STATIC_DRAW),E=s.getAttribLocation(r,"aTexturePosition"),u=s.getUniformLocation(r,"uStripe"),R=s.getUniformLocation(r,"uTexture")}t=b(i.vertex,i.fragment),n=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,n),s.bufferData(s.ARRAY_BUFFER,d,s.STATIC_DRAW),o=s.getAttribLocation(t,"aPosition"),f=s.createBuffer(),c=s.getAttribLocation(t,"aLumaPosition"),_=s.createBuffer(),m=s.getAttribLocation(t,"aChromaPosition")}(),x){var l=function(e,t,r){var i=p.cropLeft/r,a=(p.cropLeft+p.cropWidth)/r,n=(p.cropTop+p.cropHeight)/p.height,o=p.cropTop/p.height,T=new Float32Array([i,n,a,n,i,o,i,o,a,n,a,o]);s.bindBuffer(s.ARRAY_BUFFER,e),s.bufferData(s.ARRAY_BUFFER,T,s.STATIC_DRAW)};l(f,c,h.y.stride),l(_,m,h.u.stride*p.width/p.chromaWidth)}P("uTextureY",x,h.y.stride,p.height,h.y.bytes),P("uTextureCb",x,h.u.stride,p.chromaHeight,h.u.bytes),P("uTextureCr",x,h.v.stride,p.chromaHeight,h.v.bytes),a.stripe&&(U("uTextureY",x,h.y.stride,p.height),U("uTextureCb",x,h.u.stride,p.chromaHeight),U("uTextureCr",x,h.v.stride,p.chromaHeight)),s.useProgram(t),s.viewport(0,0,e.width,e.height),g("uTextureY",s.TEXTURE0,0),g("uTextureCb",s.TEXTURE1,1),g("uTextureCr",s.TEXTURE2,2),s.bindBuffer(s.ARRAY_BUFFER,n),s.enableVertexAttribArray(o),s.vertexAttribPointer(o,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,f),s.enableVertexAttribArray(c),s.vertexAttribPointer(c,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,_),s.enableVertexAttribArray(m),s.vertexAttribPointer(m,2,s.FLOAT,!1,0,0),s.drawArrays(s.TRIANGLES,0,d.length/2)},A.clear=function(){s.viewport(0,0,e.width,e.height),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT)},A.clear(),A}a.stripe=!1,a.contextForCanvas=function(e){var t={preferLowPowerToHighPerformance:!0,powerPreference:"low-power",failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0};return e.getContext("webgl",t)||e.getContext("experimental-webgl",t)},a.isAvailable=function(){var e,t=document.createElement("canvas");t.width=1,t.height=1;try{e=a.contextForCanvas(t)}catch(e){return!1}if(!e)return!1;var r=e.TEXTURE0,i=e.createTexture(),n=new Uint8Array(16),o=a.stripe?1:4,T=a.stripe?e.RGBA:e.ALPHA,E=a.stripe?e.NEAREST:e.LINEAR;return e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,E),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,E),e.texImage2D(e.TEXTURE_2D,0,T,o,4,0,T,e.UNSIGNED_BYTE,n),!e.getError()},a.prototype=Object.create(t.prototype),e.exports=a}()},2521:function(e,t,r){var i;i=r(5001),e.exports={convertYCbCr:/**
	 * Basic YCbCr->RGB conversion
	 *
	 * @author Brooke Vibber <bvibber@pobox.com>
	 * @copyright 2014-2024
	 * @license MIT-style
	 *
	 * @param {YUVFrame} buffer - input frame buffer
	 * @param {Uint8ClampedArray} output - array to draw RGBA into
	 * Assumes that the output array already has alpha channel set to opaque.
	 */function(e,t){var r=0|e.format.width,a=0|e.format.height,n=0|i(e.format.width/e.format.chromaWidth),o=0|i(e.format.height/e.format.chromaHeight),T=e.y.bytes,E=e.u.bytes,u=e.v.bytes,R=0|e.y.stride,f=0|e.u.stride,c=0|e.v.stride,_=r<<2,m=0,A=0,s=0,h=0,d=0,p=0,x=0,l=0,v=0,P=0,U=0,g=0,b=0,D=0,L=0,X=0,F=0,C=0;if(1==n&&1==o)for(X=0,x=0,l=_,C=0;X<a;X+=2){for(L=0,s=(A=X*R|0)+R|0,h=C*f|0,d=C*c|0;L<r;L+=2)v=0|E[h++],g=(409*(P=0|u[d++])|0)-57088|0,b=(100*v|0)+(208*P|0)-34816|0,D=(516*v|0)-70912|0,U=298*T[A++]|0,t[x]=U+g>>8,t[x+1]=U-b>>8,t[x+2]=U+D>>8,x+=4,U=298*T[A++]|0,t[x]=U+g>>8,t[x+1]=U-b>>8,t[x+2]=U+D>>8,x+=4,U=298*T[s++]|0,t[l]=U+g>>8,t[l+1]=U-b>>8,t[l+2]=U+D>>8,l+=4,U=298*T[s++]|0,t[l]=U+g>>8,t[l+1]=U-b>>8,t[l+2]=U+D>>8,l+=4;x+=_,l+=_,C++}else for(X=0,p=0;X<a;X++)for(L=0,F=0,C=X>>o,m=X*R|0,h=C*f|0,d=C*c|0;L<r;L++)v=0|E[h+(F=L>>n)],g=(409*(P=0|u[d+F])|0)-57088|0,b=(100*v|0)+(208*P|0)-34816|0,D=(516*v|0)-70912|0,U=298*T[m++]|0,t[p]=U+g>>8,t[p+1]=U-b>>8,t[p+2]=U+D>>8,p+=4}}},5001:function(e){e.exports=/**
   * Convert a ratio into a bit-shift count; for instance a ratio of 2
   * becomes a bit-shift of 1, while a ratio of 1 is a bit-shift of 0.
   *
   * @author Brooke Vibber <bvibber@pobox.com>
   * @copyright 2016-2024
   * @license MIT-style
   *
   * @param {number} ratio - the integer ratio to convert.
   * @returns {number} - number of bits to shift to multiply/divide by the ratio.
   * @throws exception if given a non-power-of-two
   */function(e){for(var t=0,r=e>>1;0!=r;)r>>=1,t++;if(e!==1<<t)throw"chroma plane dimensions must be power of 2 ratio to luma plane dimensions; got "+e;return t}},7875:function(e,t,r){var i,a,n;i=r(5053),a=r(4820),n=r(478),e.exports={FrameSink:i,SoftwareFrameSink:a,WebGLFrameSink:n,attach:function(e,t){return("webGL"in(t=t||{})?t.webGL:n.isAvailable())?new n(e,t):new a(e,t)}}}}]);
//# sourceMappingURL=875.f998721722528232.js.map